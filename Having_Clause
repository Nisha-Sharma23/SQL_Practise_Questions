-- 1.WAQTD DNO AND NUMBER OF CLERKS WORKING IN EACH DEPT IF THERE ARE ATLEAST 2 CLERKS IN EACH DEPT 
USE SCOTT;
SELECT * FROM DEPT;
SELECT * FROM EMP;
SELECT DEPTNO, COUNT(*) FROM EMP
 WHERE JOB="CLERK" 
 GROUP BY DEPTNO
 HAVING COUNT(*)>=2 ;
 
 -- 2.WAQTD DNO AND TOTAL SAALARY NEEDED TO PAY ALL EMP  IN EACH DEPT IF THERE ARE ATLEAST 4 EMP IN EACH DEPT
 
 SELECT DEPTNO, SUM(SAL)TOTAL_SAL FROM EMP 
 GROUP BY DEPTNO 
 HAVING  COUNT(*)>=4;
 
  -- 3.WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1200 IN EACH JOB  AND THE TOTAL SAL NEEDED TO PAY EMP OF EACH JOB MUST EXCEED 3800
  SELECT  JOB,COUNT(*)TOTAL_EMP FROM EMP 
  WHERE SAL>1200 
  GROUP BY JOB
  HAVING SUM(SAL)>3800;

-- 4.WAQTD DEPTNO AND NUMBER OF EMP WORKING ONLY IF THERE ARE 2 EMP WORKING IN EACH DEPT AS CLERK   

SELECT DEPTNO,COUNT(*) FROM EMP
WHERE JOB="CLERK"
GROUP BY DEPTNO
HAVING COUNT(*)=2;

-- 5.WAQTD JOB AND MAX SAL OF EMP IN EACH JOB IF THE MAX SAL EXCEEDS 2600
SELECT JOB, MAX(SAL) FROM EMP
GROUP BY JOB
HAVING MAX(SAL)>2600; 
 
 -- .WAQTD THE SALARIES WHICH ARE REPEATED IN EMP TABLE
 SELECT SAL, COUNT(*) FROM EMP
 GROUP BY SAL 
 HAVING COUNT(*)>1;
 
--  7.WAQTD THE HIREDATE WHICH ARE DUPLICATED IN EMP TABLE
SELECT HIREDATE, COUNT(*) FROM EMP
GROUP BY HIREDATE
HAVING COUNT(*)>1;

--  .WAQTD AVG SALARY OF EACH DEPT IF AVG SAL IS LESS THan 3000
SELECT DEPTNO, AVG(SAL) FROM EMP
group by DEPTNO 
HAVING AVG(SAL)<3000; 

-- 9.WAQTD DEPTNO IF THERE ARE ATLEAST 3 EMP IN  EACH DEPT WHOS NAME HAS CHAR 'A' OR 'S'  
SELECT DEPTNO ,COUNT(*) FROM EMP
WHERE ENAME LIKE "%A%" OR ENAME LIKE "%S%"
GROUP BY DEPTNO
HAVING COUNT(*)>=3;


-- 10.WAQTD MIN AND MAX SALARIES OF EACH JOB IF MIN  SAL IS MORE THAN 1000 AND MAX SAL IS LESS THAN 5000 

SELECT  JOB, MIN(SAL), MAX(SAL)
FROM EMP GROUP BY JOB
HAVING MIN(SAL)>1000 AND MAX(SAL)<5000;

--  11. WAQTD ENAME WHO IS EARNING MORE THAN SMITH 
SELECT ENAME FROM EMP WHERE SAL>(SELECT SAL FROM EMP WHERE ENAME="SMITH");
